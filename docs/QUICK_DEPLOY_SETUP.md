# üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–¥–µ–ø–ª–æ—è

## –û–±–∑–æ—Ä

–£–ª—É—á—à–µ–Ω–Ω—ã–π GitHub Actions workflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ VPS —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ù–∞ VPS:
- ‚úÖ Node.js 20+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ PM2 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`npm install -g pm2`)
- ‚úÖ SSH –¥–æ—Å—Ç—É–ø –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/var/www/app` —Å–æ–∑–¥–∞–Ω–∞

### –í GitHub:
- ‚úÖ SSH –∫–ª—é—á –¥–ª—è –¥–µ–ø–ª–æ—è
- ‚úÖ GitHub Secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

## üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

### 1. –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–∞:

```bash
# –°–æ–∑–¥–∞–µ–º SSH –∫–ª—é—á
ssh-keygen -t rsa -b 4096 -C "deploy@roleplayidentity" -f ~/.ssh/deploy_key

# –ö–æ–ø–∏—Ä—É–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ VPS
ssh-copy-id -i ~/.ssh/deploy_key.pub username@your-vps-ip
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Secrets –≤ GitHub:

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings > Secrets and variables > Actions** –∏ –¥–æ–±–∞–≤—å—Ç–µ:

#### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ Secrets –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
| Secret | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|----------|
| `VPS_HOST` | `your-vps-ip-or-domain.com` |
| `VPS_USER` | `username` |
| `DEPLOY_KEY` | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ `~/.ssh/deploy_key` |

#### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ Secrets –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
| Secret | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|----------|
| `NODE_ENV` | `production` |
| `PORT` | `5000` |
| `SUPABASE_URL` | `https://axgtvvcimqoyxbfvdrok.supabase.co` |
| `SUPABASE_ANON_KEY` | `your-anon-key` |
| `SUPABASE_SERVICE_ROLE_KEY` | `your-service-role-key` |
| `DATABASE_URL` | `postgresql://postgres.axgtvvcimqoyxbfvdrok:[PASSWORD]@aws-0-eu-north-1.pooler.supabase.com:5432/postgres` |
| `JWT_SECRET` | `your-very-long-and-secure-jwt-secret-at-least-32-characters` |

#### **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ Secrets –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞:**
| Secret | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|----------|
| `VITE_SUPABASE_URL` | `https://axgtvvcimqoyxbfvdrok.supabase.co` |
| `VITE_SUPABASE_ANON_KEY` | `your-anon-key` |

## üõ†Ô∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:

```bash
sudo mkdir -p /var/www/app
sudo chown $USER:$USER /var/www/app
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2:

```bash
sudo npm install -g pm2
pm2 startup
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–µ–¥–ª–æ–∂–∏—Ç PM2
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

**–¢–µ–ø–µ—Ä—å .env —Ñ–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ GitHub Secrets!**

## üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions** ‚Üí **Deploy to VPS**
2. –ù–∞–∂–º–∏—Ç–µ **Run workflow**
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É `main`
4. –ù–∞–∂–º–∏—Ç–µ **Run workflow**

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫:
–ü—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫—É `main` –¥–µ–ø–ª–æ–π –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:
```bash
# –ù–∞ VPS
pm2 status
pm2 logs roleplayidentity

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
netstat -tlnp | grep :5000

# –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
cat /var/www/app/.env
```

### –õ–æ–≥–∏ GitHub Actions:
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Actions** ‚Üí **Deploy to VPS**
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

## üö® Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: SSH –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
ssh -i ~/.ssh/deploy_key username@your-vps-ip

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
chmod 600 ~/.ssh/deploy_key
```

### –ü—Ä–æ–±–ª–µ–º–∞: PM2 –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
```bash
sudo npm install -g pm2
pm2 --version
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
pm2 logs roleplayidentity --lines 50

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
pm2 env roleplayidentity

# –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
cat /var/www/app/.env
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç GitHub Secrets
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ Secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ GitHub
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings > Secrets and variables > Actions
```

## ‚ö° –ß—Ç–æ –¥–µ–ª–∞–µ—Ç workflow:

1. **Checkout** - –∫–ª–æ–Ω–∏—Ä—É–µ—Ç –∫–æ–¥
2. **Setup Node.js** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Node.js 20 —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. **Install dependencies** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
4. **Build** - —Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–∑ Secrets
5. **Install production dependencies** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ production –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
6. **Create deployment package** - —Å–æ–∑–¥–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ (–±–µ–∑ env.example)
7. **Deploy** - –∫–æ–ø–∏—Ä—É–µ—Ç –∞—Ä—Ö–∏–≤ –Ω–∞ VPS
8. **Setup & Restart** - —Å–æ–∑–¥–∞–µ—Ç .env –∏–∑ Secrets –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
9. **Health check** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

## üöÄ –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

- ‚úÖ **–ü–µ—Ä–µ–¥–∞—á–∞ Secrets –ø—Ä–∏ —Å–±–æ—Ä–∫–µ** - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤–æ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ .env** - —Ñ–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏–∑ GitHub Secrets
- ‚úÖ **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ env.example** - –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç** - `pm2 reload` –≤–º–µ—Å—Ç–æ stop/delete/start
- ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - npm –∫—ç—à –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞** - —Å–∂–∞—Ç—ã–π –∞—Ä—Ö–∏–≤ –≤–º–µ—Å—Ç–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–µ–ø–ª–æ—è](DEPLOYMENT_OPTIMIZATIONS.md)

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å—Å—è –Ω–∞ VPS –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫—É `main`.

**–í—Ä–µ–º—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** ~15 –º–∏–Ω—É—Ç
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è
**–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è
**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è 